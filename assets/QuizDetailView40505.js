import{v as ke}from"./runtime-dom.esm-bundler40505.js";import{d as fe,af as pe,r as h,o as Ae,ab as Je,b,l as $e,e as o,f as p,g as a,C as H,A as V,h as i,m as S,j as _,i as I,z as y,w as ae,q as Ke,u as We,c as Ue,am as ce,F as ze,y as Xe,a as et}from"./usetoast.esm40505.js";import{u as Te}from"./quiz40505.js";import{a as M,e as Z,s as W,h as L,d as tt,f as at,g as lt,u as st,j as nt,b as ot,c as it}from"./helpers40505.js";import{A as ut}from"./AudienceCard40505.js";import{U as rt}from"./UploadImageCard40505.js";import{a as me,b as dt,c as ve}from"./formatData40505.js";import{u as ct}from"./useconfirm.esm40505.js";import{u as mt}from"./attachment40505.js";import{U as vt}from"./UploadAttachmentCard40505.js";import"./group40505.js";import"./user40505.js";import"./_plugin-vue_export-helper40505.js";import"./datetime40505.js";const ft={key:0,class:"formgrid grid col-12 px-0 align-items-center"},pt={class:"field col-5"},gt={for:"note"},_t={class:"uppercase"},ht={key:0,class:"p-error"},xt={key:0,class:"field col-5"},yt={for:"note"},wt={class:"uppercase"},bt={key:0,class:"p-error"},Vt={class:"field col-12 flex flex-column mt-3"},qt={class:"field flex align-items-center"},Ct={class:"field col-5 p-0 mr-3"},kt={for:"answer"},Ut={class:"uppercase"},zt={key:0,class:"p-error"},At={key:0,class:"field col-5 p-0"},$t={for:"answer"},Tt={class:"uppercase"},Dt={key:0,class:"p-error"},St={class:"field-checkbox pt-3"},It=a("label",{for:"isRightAnswer"},"Correct answer",-1),Ft={key:0},Qt={key:1},Et={key:0},jt={key:1},Bt=a("div",{class:"flex justify-content-center text-center w-full"}," Correct answer ",-1),Nt={class:"flex justify-content-center"},Rt={key:0,class:"pi pi-check",style:{color:"#00a19c"}},Lt={class:"flex justify-content-center"},Mt=fe({__name:"TabQuestionQuiz",props:{index:null,quiz:null,languages:null,submitForm:null},emits:["updateAnswer","updateText"],setup(s,{emit:J}){const r=s,F=pe(),q=Te(),x=h(),z=h(),O=h(!1),C=h(),A=h(),Q=h([]),w=h([]),U=h(!1);Ae(()=>{var m,u;x.value=((m=r.quiz.questions[r.index].translations[r.languages[0]])==null?void 0:m.text)??"",z.value=((u=r.quiz.questions[r.index].translations[r.languages[1]])==null?void 0:u.text)??""});const k=function(m){if(r.submitForm)return m==""||m==null?O.value=!0:O.value=!1,O.value},E=async function(m,u){m?await q.deleteAnswerFromQuiz(m).then(()=>{M(F,{message:"Answer deleted correctly.",title:""}),r.quiz.questions[r.index].answers.splice(u,1)}).catch(d=>{Z(F,d)}):r.quiz.questions[r.index].answers.splice(u,1)},$=function(){M(F,{message:"There can only be one correct answer.",error:!0})},e=function(){if(U.value===!0&&le()){$(),U.value=!1;return}const m={};let u=r.languages[0],d=r.languages[1];m[u]&&m[u].text?m[u].text=C.value:m[u]={text:C.value},d&&(m[d]&&m[d].text?m[d].text=A.value:m[d]={text:A.value}),w.value||(w.value=[]);const v={translation:m,index:r.index,right_answer:U.value};J("updateAnswer",v),C.value="",A.value="",U.value=!1},le=()=>{var m;return((m=r.quiz.questions[r.index].answers)==null?void 0:m.some(u=>u.right_answer))||!1},se=async function(m,u){const d={quiz_answer:{right_answer:u}};W();try{await q.updateAnswerRightAnswer(m,d)}catch(v){Z(F,v)}finally{L()}},ne=async m=>{let{data:u,newData:d,index:v}=m;const G=d.translations[r.languages[0]].id;if(G&&(u.right_answer!==d.right_answer&&await se(d.id,d.right_answer),await f(G,d.translations[r.languages[0]].text)),J("updateAnswer",{index:r.index,answerIndex:v,right_answer:d.right_answer}),r.languages[1]){const j=d.translations[r.languages[1]].id;j&&await f(j,d.translations[r.languages[1]].text)}},f=async function(m,u){const d={id:m,text:u};await q.updateAnswer(d).then(()=>{M(F,{message:"Answer update correctly.",title:""})}).catch(v=>{Z(F,v)})};return Je(r.quiz,()=>{r.quiz.questions[r.index]&&(x.value=r.quiz.questions[r.index].translations[r.languages[0]].text)}),(m,u)=>{const d=b("InputText"),v=b("Checkbox"),G=b("Button"),j=b("Column"),oe=b("DataTable"),ie=$e("tooltip");return s.languages?(o(),p("div",ft,[a("div",pt,[a("label",gt,[H("Question* "),a("span",_t,"("+V(s.languages[0])+")",1)]),i(d,{type:"text",modelValue:x.value,"onUpdate:modelValue":[u[0]||(u[0]=n=>x.value=n),u[1]||(u[1]=n=>m.$emit("updateText",{index:s.index,text:x.value,lang:s.languages[0]}))],class:S(["w-full",{"p-invalid":k(x.value)}])},null,8,["modelValue","class"]),k(x.value)?(o(),p("small",ht,"Campo obbligatorio.")):_("",!0)]),s.languages[1]?(o(),p("div",xt,[a("label",yt,[H("Question* "),a("span",wt,"("+V(s.languages[1])+")",1)]),i(d,{type:"text",modelValue:z.value,"onUpdate:modelValue":[u[2]||(u[2]=n=>z.value=n),u[3]||(u[3]=n=>m.$emit("updateText",{index:s.index,text:z.value,lang:s.languages[1]}))],class:S(["w-full",{"p-invalid":k(z.value)}])},null,8,["modelValue","class"]),k(z.value)?(o(),p("small",bt,"Campo obbligatorio.")):_("",!0)])):_("",!0),a("div",Vt,[a("div",qt,[a("div",Ct,[a("label",kt,[H("Answer* "),a("span",Ut,"("+V(s.languages[0])+")",1)]),i(d,{type:"text",modelValue:C.value,"onUpdate:modelValue":u[4]||(u[4]=n=>C.value=n),class:S(["w-full",{"p-invalid":s.quiz.answers&&s.quiz.answers.length<1&&k(C.value)}]),id:"answer"},null,8,["modelValue","class"]),s.quiz.answers&&s.quiz.answers.length<1&&k(C.value)?(o(),p("small",zt,"Campo obbligatorio.")):_("",!0)]),s.languages[1]?(o(),p("div",At,[a("label",$t,[H("Answer* "),a("span",Tt,"("+V(s.languages[1])+")",1)]),i(d,{type:"text",modelValue:A.value,"onUpdate:modelValue":u[5]||(u[5]=n=>A.value=n),class:S(["w-full",{"p-invalid":s.quiz.answers&&s.quiz.answers.length<1&&k(A.value)}]),id:"answer"},null,8,["modelValue","class"]),s.quiz.answers&&s.quiz.answers.length<1&&k(A.value)?(o(),p("small",Dt,"Campo obbligatorio.")):_("",!0)])):_("",!0),a("div",St,[i(v,{"input-id":"isRightAnswer",binary:"",modelValue:U.value,"onUpdate:modelValue":u[6]||(u[6]=n=>U.value=n)},null,8,["modelValue"]),It]),i(G,{label:"Add answer",class:"p-button-outlined ml-3 mt-2",onClick:e,disabled:!C.value||s.languages[1]&&!A.value},null,8,["disabled"])]),s.quiz.questions&&s.quiz.questions[s.index]&&s.quiz.questions[s.index].answers.length>0?(o(),I(oe,{key:0,value:s.quiz.questions[s.index].answers,responsiveLayout:"scroll",editMode:"row",editingRows:Q.value,"onUpdate:editingRows":u[7]||(u[7]=n=>Q.value=n),onRowEditSave:ne},{default:y(()=>[i(j,{field:"",header:s.languages[0].toUpperCase()},{body:y(({data:n})=>[n.translations[s.languages[0]]&&(n.translations[s.languages[0]].text||n.translations[s.languages[0]].text=="")?(o(),p("span",Ft,V(n.translations[s.languages[0]].text),1)):(o(),p("span",Qt,V(n.translations[s.languages[0]]),1))]),editor:y(({data:n})=>[n.translations[s.languages[0]]&&(n.translations[s.languages[0]].text||n.translations[s.languages[0]].text=="")?(o(),I(d,{key:0,class:"w-full",modelValue:n.translations[s.languages[0]].text,"onUpdate:modelValue":T=>n.translations[s.languages[0]].text=T},null,8,["modelValue","onUpdate:modelValue"])):(o(),I(d,{key:1,modelValue:n.translations[s.languages[0]],"onUpdate:modelValue":T=>n.translations[s.languages[0]]=T,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1},8,["header"]),s.languages[1]?(o(),I(j,{key:0,field:"",header:s.languages[1].toUpperCase()},{body:y(({data:n})=>[n.translations[s.languages[1]]&&(n.translations[s.languages[1]].text||n.translations[s.languages[1]].text=="")?(o(),p("span",Et,V(n.translations[s.languages[1]].text),1)):(o(),p("span",jt,V(n.translations[s.languages[1]]),1))]),editor:y(({data:n})=>[n.translations[s.languages[1]]&&(n.translations[s.languages[1]].text||n.translations[s.languages[1]].text=="")?(o(),I(d,{key:0,class:"w-full",modelValue:n.translations[s.languages[1]].text,"onUpdate:modelValue":T=>n.translations[s.languages[1]].text=T},null,8,["modelValue","onUpdate:modelValue"])):(o(),I(d,{key:1,modelValue:n.translations[s.languages[1]],"onUpdate:modelValue":T=>n.translations[s.languages[1]]=T,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]))]),_:1},8,["header"])):_("",!0),i(j,{field:"right_answer",class:"col-2"},{header:y(()=>[Bt]),body:y(({data:n})=>[a("div",Nt,[n.right_answer?(o(),p("i",Rt)):_("",!0)])]),editor:y(({data:n})=>[a("div",Lt,[i(v,{binary:"",modelValue:n.right_answer,"onUpdate:modelValue":T=>n.right_answer=T},null,8,["modelValue","onUpdate:modelValue"])])]),_:1}),i(j,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"}),i(j,{header:"",style:{width:"9rem"}},{body:y(({data:n,index:T})=>[ae(i(G,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",class:"p-button-text p-button-rounded text-300 surface-200 mr-3",icon:"pi pi-trash",onClick:ge=>E(n.id,T)},null,8,["onClick"]),[[ie,"Delete",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","editingRows"])):_("",!0)])])):_("",!0)}}}),Ot={class:"flex align-items-center justify-content-between"},Pt={class:"mb-4"},Ht={class:"flex"},Gt={key:0},Yt=["src"],Zt={key:0,class:"text-center"},Jt=a("b",null,"Drag and drop video to here to upload.",-1),Kt=a("p",{class:"text-xs"},"(Maximum size 20 MB)",-1),Wt=[Jt,Kt],Xt=a("div",{class:"text-center"},[a("b",null,"Drag and drop video to here to upload."),a("p",{class:"text-xs"},"(Maximum size 20 MB)")],-1),ea=fe({__name:"UploadVideoFileCard",props:{title:null,dynamicClass:null},emits:["update:modelValue"],setup(s,{expose:J,emit:r}){const F=pe(),q=mt(),x=h(),z=h(),O=async function(Q){const w=Q.files[0],U=URL.createObjectURL(w);U&&(x.value={url:U,id:""}),w&&r("update:modelValue",w)},C=async function(){x.value=null,z.value.files=[],r("update:modelValue",null)},A=async()=>{var Q;(Q=x.value)!=null&&Q.id&&(W(),await q.deleteAttachment(x.value.id).then(()=>{L(),M(F,{message:"File deleted correctly.",title:""}),C()}).catch(w=>{L(),Z(F,w)}))};return J({videoUrl:x,fileUploadRef:z}),(Q,w)=>{const U=b("Button"),k=b("FileUpload"),E=b("Card");return o(),I(E,{class:"h-full"},{content:y(()=>[a("div",Ot,[a("h2",Pt,V(s.title),1)]),a("div",Ht,[a("div",{class:S(["flex-column p-0",s.dynamicClass||"col-6"])},[x.value&&x.value.url?(o(),I(k,{key:0,name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,accept:"video/mp4",maxFileSize:2e7,customUpload:!0,fileLimit:1,onSelect:w[1]||(w[1]=$=>O($)),onRemove:C,ref_key:"fileUploadRef",ref:z,modelValue:x.value.url,"onUpdate:modelValue":w[2]||(w[2]=$=>x.value.url=$)},{content:y(()=>[x.value?(o(),p("div",Gt,[a("video",{src:x.value.url,controls:"",width:"400"},null,8,Yt),i(U,{icon:"pi pi-times",onClick:w[0]||(w[0]=$=>x.value&&x.value.id?A():C()),class:"p-button p-component p-button-icon-only p-fileupload-file-remove p-button-text p-button-danger p-button-rounded"})])):_("",!0)]),empty:y(()=>[x.value?_("",!0):(o(),p("div",Zt,Wt))]),_:1},8,["modelValue"])):(o(),I(k,{key:1,name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,accept:"video/mp4",maxFileSize:2e7,customUpload:!0,fileLimit:1,onSelect:w[3]||(w[3]=$=>O($)),onRemove:C,ref_key:"fileUploadRef",ref:z},{empty:y(()=>[Xt]),_:1},512))],2)])]),_:1})}}}),ta={class:"m-4"},aa={class:"flex justify-content-between align-items-center mb-3"},la={class:"flex flex-row"},sa={class:"flex align-items-center justify-content-between"},na=a("h2",{class:"mb-2"},"VIDEO PILL DETAILS",-1),oa={key:0,class:"field col-2 mb-0"},ia={class:"formgrid grid col-10 px-0"},ua={class:"field col-3"},ra=a("label",{for:"name"},"Active from*",-1),da={key:0,class:"p-error"},ca={class:"field col-3"},ma=a("label",{for:"name"},"Active to*",-1),va={key:0,class:"p-error"},fa={class:"field col-4"},pa=a("label",{for:"name"},"Visible until*",-1),ga={key:0,class:"p-error"},_a=a("div",{class:"flex align-items-center justify-content-between"},[a("h2",{class:"mb-3"},"CONTENT")],-1),ha={key:0,class:"formgrid grid col-12 px-0"},xa={class:"field col-5 flex flex-column"},ya={for:"title"},wa={class:"uppercase"},ba=a("span",{class:"text-sm font-italic"},"Maximum 450 characters",-1),Va={key:0,class:"p-error"},qa={key:0,class:"field col-5 flex flex-column"},Ca={for:"title"},ka={class:"uppercase"},Ua=a("span",{class:"text-sm font-italic"},"Maximum 450 characters",-1),za={key:0,class:"p-error"},Aa={key:1,class:"formgrid grid col-12 px-0"},$a={class:"field col-5 flex flex-column"},Ta={for:"short_description"},Da={class:"uppercase"},Sa=a("span",{class:"text-sm font-italic"},"Maximum 450 characters",-1),Ia={key:0,class:"field col-5 flex flex-column"},Fa={for:"short_description"},Qa={class:"uppercase"},Ea=a("span",{class:"text-sm font-italic"},"Maximum 450 characters",-1),ja={key:2,class:"formgrid grid col-12 px-0"},Ba={class:"field col-5 flex flex-column"},Na={for:"title"},Ra={class:"uppercase"},La=a("span",{class:"ql-formats"},[a("button",{class:"ql-bold"}),a("button",{class:"ql-italic"}),a("button",{class:"ql-underline"}),a("button",{class:"ql-link"})],-1),Ma={key:0,class:"field col-5 flex flex-column"},Oa={for:"description"},Pa={class:"uppercase"},Ha=a("span",{class:"ql-formats"},[a("button",{class:"ql-bold"}),a("button",{class:"ql-italic"}),a("button",{class:"ql-underline"}),a("button",{class:"ql-link"})],-1),Ga=a("div",{class:"flex align-items-center justify-content-between"},[a("h2",{class:"mb-3"},"QUIZ")],-1),Ya={key:0,class:"flex formgrid grid col-12 align-items-center"},Za={class:"field col-2 flex flex-column"},Ja=a("label",{for:"note"},"Number of questions* ",-1),Ka=a("div",{class:"col-1"},null,-1),Wa=["onClick"],Xa={class:"flex p-3 align-items-center"},el={class:"pl-2"},tl={class:"flex align-items-center pb-3 justify-content-end"},al={class:"flex p-3 align-items-center"},ll={class:"pl-2"},sl={class:"flex align-items-center pb-3 justify-content-end"},nl={class:"col-12 mb-2 px-3"},ol=a("h2",{class:"mb-3"},"Last push notifications",-1),wl=fe({__name:"QuizDetailView",setup(s){const J=Ke(),r=Te(),F=We(),q=pe(),x=ct(),z=h(0),O=h(0),C=h([]),A=h(),Q=h(),w=h(),U=h(!1),k=h(!1),E=h(""),$=h([{label:""}]),e=h({}),le=h({}),se=h([]),ne=[{label:"Online",value:!0},{label:"Offline",value:!1}],f=h([]),m=h(!1),u=h(null),d=h(),v=Ue(()=>r.getCurrentQuiz),G=Ue(()=>F.getSelectedCountry);Ae(async()=>{E.value=J.params.id||"",E.value?($.value[0]={label:"Edit video pill"},te(E.value)):($.value[0]={label:"New video pill"},De())});const j=async function(){var l;if(U.value=!0,oe(),!ie()){M(q,{message:"There must be exactly one correct answer per question.",title:"",error:!0});return}if(k.value){M(q,{message:"Check that you have completed the required fields.",title:"",error:!0});return}E.value!==""||(l=e.value)!=null&&l.id?await ge():await T()},oe=function(){let l=!1;ue(e.value.active_from),ue(e.value.active_to),ue(e.value.hidden_at),k.value=l},ie=function(){if(e.value.questions)for(const l of e.value.questions){let t=0;for(const g of l.answers)g.right_answer&&t++;if(t!==1)return!1}return!0},n=function(){var D;const l=new FormData,t={...e.value};t.active_from=ve(e.value.active_from),t.active_to=ve(e.value.active_to),t.hidden_at=ve(e.value.hidden_at),t.country_id=(D=t.country)==null?void 0:D.id,delete t.country,(E.value||t.id)&&st(v,e.value);const g=A.value.tmp_image;if(g&&g.image&&(t.image=g.image),u.value&&(t.video=u.value),d.value){const B=d.value.files;B&&B.length>0&&B.length>0&&nt(B,"quiz[attachments][]",l)}t.answers=[];for(const B in e.value.answers){const Y=e.value.answers[B];Y.id?t.answers.push({}):t.answers.push(Y)}return t.hide_results||(t.hide_results="false"),delete t.target_all,delete t.target_clusters,delete t.target_group_ids,delete t.target_groups,delete t.created_at,delete t.updated_at,delete t.can_edit,delete t.can_delete,ot(l,t,"quiz"),it(w,l,"quiz"),l},T=async function(){const l={formData:n()};W();try{await r.createQuiz(l),v.value&&v.value.id&&(M(q,{message:"Quiz created correctly",title:""}),await et.replace({name:"quiz-detail",params:{id:v.value.id}}),$.value[0]={label:"Edit video pill"},await te(v.value.id),E.value=J.params.id||"")}catch(t){Z(q,t)}finally{L()}},ge=async function(){const l={id:e.value.id,formData:n()};W(),r.updateQuiz(l).then(()=>{L(),m.value?_e():(te(e.value.id+""),M(q,{message:"Quiz updated correctly.",title:""})),d.value.files=[],d.value.fileUpload.files=[]}).catch(t=>{L(),Z(q,t)})},De=function(){var l,t;e.value={country_id:G.value.id,country:G.value,online:!1,typology:"closed",can_edit:!0},e.value.translations={},(t=(l=G.value)==null?void 0:l.language_codes)==null||t.forEach(g=>{f.value.push(g),e.value.translations[g]={title:null,short_description:null,description:null}}),e.value.questions_number=1,X()},te=async function(l){W();try{await r.getQuizDetail(l),Ee()}catch(t){Z(q,t)}finally{L()}},P=function(l){if(U.value)return l==""||l==null?k.value=!0:k.value=!1,k.value},ue=function(l,t){U.value},Se=()=>{e.value.hidden_at||(e.value.hidden_at=e.value.active_to)},X=function(){var l,t;C.value=[];for(let g=0;g<+e.value.questions_number;g++){let B={title:"Question "+(g+1),content:""};if(C.value.push(B),e.value.questions||(e.value.questions=[]),!e.value.questions[g]){const Y={answers:[],translations:{}};(t=(l=e.value.country)==null?void 0:l.language_codes)==null||t.forEach(ee=>{Y.translations[ee]={text:null}}),e.value.questions[g]=Y}e.value.questions[g].typology="closed"}O.value=0,document.getElementsByClassName("p-tabview-nav-link")&&document.getElementsByClassName("p-tabview-nav-link")[0]&&document.getElementsByClassName("p-tabview-nav-link")[0].click()},Ie=(l,t)=>{x.require({group:"delete",target:l.currentTarget,message:"Are you sure you want to delete this question?",icon:"pi pi-exclamation-triangle",acceptLabel:t})},Fe=function(l){var t,g,D;e.value.questions&&(l.answerIndex!==void 0?e.value.questions[l.index].answers[l.answerIndex].right_answer=l.right_answer:(e.value.questions[l.index]||(e.value.questions[l.index]={answers:[]}),(D=(g=(t=e.value)==null?void 0:t.questions[l.index])==null?void 0:g.answers)==null||D.push({translations:l.translation,right_answer:l.right_answer})))},Qe=function(l){e.value.questions&&(e.value.questions[l.index].translations[l.lang].text=l.text)},Ee=function(){if(v.value){if(e.value=Object.assign({},v.value),v.value.active_from&&(e.value.active_from=me(v.value.active_from+"")),v.value.active_to&&(e.value.active_to=me(v.value.active_to+"")),v.value.hidden_at&&(e.value.hidden_at=me(v.value.hidden_at+"")),Be(),tt(v,e),d.value){const l=e.value.attachments_url;l&&l.length>0&&(d.value.tmp_attachment=l)}for(const l in e.value.answers)for(const t in e.value.answers[+l].translations){const g=e.value.answers[+l];delete g.translations[t].updated_at,delete g.translations[t].created_at}at(w,e),lt(A,e),je(e.value),X()}},je=function(l){l.video_url&&(Q.value.videoUrl=l.video_url)},Be=function(){var l;e.value.answers||(e.value.answers=[]),f.value=[],(l=e.value.country.language_codes)==null||l.forEach((t,g)=>{f.value.push(t),le.value[t]="",se.value.push({field:"lang",header:t})})},Ne=async function(l){var t,g;if(!((t=v==null?void 0:v.value)!=null&&t.online&&e.value.online)){if(!((g=v==null?void 0:v.value)!=null&&g.online)&&e.value.online){m.value=!0,await j();return}_e()}},_e=async function(){const l=new Map;l.set("online",e.value.online),l.set("quiz_id",e.value.id),await r.changeStatusQuiz(l).then(()=>{te(e.value.id+""),M(q,{message:"Quiz status changed correctly",title:""}),m.value=!1})},Re=function(l){u.value=l,u.value===null&&e.value.video_url&&delete e.value.video_url},Le=l=>{x.require({group:"push",target:l.currentTarget,message:"Are you sure you want to send the push notification?",icon:"pi pi-exclamation-triangle"})},re=function(){if(document.getElementsByClassName("p-confirm-dialog-reject")&&document.getElementsByClassName("p-confirm-dialog-reject")[0]){var l=document.getElementsByClassName("p-confirm-dialog-reject")[0];l.click()}if(document.getElementsByClassName("p-confirm-dialog-reject")&&document.getElementsByClassName("p-confirm-dialog-reject")[1]){var t=document.getElementsByClassName("p-confirm-dialog-reject")[1];t.click()}},Me=async function(){W(),await r.sendPush(e.value.id+"").then(()=>{M(q,{message:"Notification sent correctly.",title:"",error:!1}),re(),L()}).catch(l=>{L(),Z(q,l)})},Oe=function(l){let t=l;e.value.questions[t]&&(e.value.questions[t].id?(Pe(e.value.questions[t].id),e.value.questions_number=e.value.questions_number-1):(e.value.questions.splice(t,1),z.value+=1,e.value.questions_number=e.value.questions_number-1,X()))},Pe=async function(l){W(),await r.deleteQuestion(l).then(()=>{M(q,{message:"Question successfully deleted",title:"",error:!1});for(let t=0;t<e.value.questions.length;t++)e.value.questions[t].id==l&&(e.value.questions.splice(t,1),z.value+=1);X(),L()}).catch(t=>{L(),Z(q,t)})},He=l=>{x.require({target:l.currentTarget,message:"",group:"notification-group",icon:"",acceptIcon:"",rejectIcon:""})};return(l,t)=>{var we;const g=b("Breadcrumb"),D=b("Button"),B=b("Dropdown"),Y=b("Calendar"),ee=b("Card"),he=b("InputText"),xe=b("Textarea"),ye=b("Editor"),Ge=b("TabPanel"),Ye=b("TabView"),de=b("ConfirmPopup"),Ze=$e("tooltip");return o(),p(ze,null,[a("div",ta,[a("div",aa,[i(g,{home:{icon:"pi pi-home",to:"/quiz"},model:$.value,class:"mt-0 p-0"},null,8,["model"]),a("div",la,[(we=ce(v))!=null&&we.notification_counter?(o(),p("i",{key:0,class:"pi info-icon mr-1",onClick:t[0]||(t[0]=c=>He(c))})):_("",!0),e.value.id?(o(),I(D,{key:1,label:"Send push",class:"mr-3 p-button-outlined",icon:"pi pi-envelope",onClick:t[1]||(t[1]=c=>Le(c))})):_("",!0),i(D,{label:"Save",onClick:t[2]||(t[2]=c=>j()),disabled:!e.value.can_edit},null,8,["disabled"])])]),i(ee,null,{content:y(()=>[a("div",sa,[na,e.value.country?(o(),p("div",oa,[i(B,{disabled:!E.value,modelValue:e.value.online,"onUpdate:modelValue":t[3]||(t[3]=c=>e.value.online=c),options:ne,optionLabel:"label",optionValue:"value",class:"w-full capitalize dropdown-status",onChange:t[4]||(t[4]=c=>Ne(c))},null,8,["disabled","modelValue"])])):_("",!0)]),a("div",ia,[a("div",ua,[ra,i(Y,{inputId:"dateformat",modelValue:e.value.active_from,"onUpdate:modelValue":t[5]||(t[5]=c=>e.value.active_from=c),dateFormat:"dd/mm/yy",manualInput:!1,class:S({"p-invalid":P(e.value.active_from)}),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),P(e.value.active_from)?(o(),p("small",da,"Campo obbligatorio.")):_("",!0)]),a("div",ca,[ma,i(Y,{inputId:"dateformat",modelValue:e.value.active_to,"onUpdate:modelValue":t[6]||(t[6]=c=>e.value.active_to=c),dateFormat:"dd/mm/yy",manualInput:!1,class:S({"p-invalid":P(e.value.active_to)}),onDateSelect:t[7]||(t[7]=c=>Se()),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),P(e.value.active_to)?(o(),p("small",va,"Campo obbligatorio.")):_("",!0)]),a("div",fa,[pa,i(Y,{inputId:"dateformat",modelValue:e.value.hidden_at,"onUpdate:modelValue":t[8]||(t[8]=c=>e.value.hidden_at=c),dateFormat:"dd/mm/yy",manualInput:!1,class:S({"p-invalid":P(e.value.hidden_at)}),placeholder:"gg/mm/aaaa"},null,8,["modelValue","class"]),P(e.value.hidden_at)?(o(),p("small",ga,"Campo obbligatorio.")):_("",!0)])])]),_:1}),ae(i(ut,{ref_key:"audienceCard",ref:w},null,512),[[ke,e.value.country]]),i(ee,{class:"mt-3"},{content:y(()=>{var c,K,N,be,Ve,qe,Ce;return[_a,e.value&&e.value.translations&&((c=e.value.country)!=null&&c.language_codes)?(o(),p("div",ha,[a("div",xa,[a("label",ya,[H("Title* "),a("span",wa,"("+V(f.value[0])+")",1)]),i(he,{id:"title",type:"text",modelValue:e.value.translations[f.value[0]].title,"onUpdate:modelValue":t[9]||(t[9]=R=>e.value.translations[f.value[0]].title=R),class:S({"p-invalid":P(e.value.translations[f.value[0]].title)}),maxlength:"450"},null,8,["modelValue","class"]),ba,P((K=e.value.translations[f.value[0]])==null?void 0:K.title)?(o(),p("small",Va,"Campo obbligatorio.")):_("",!0)]),(N=e.value.country)!=null&&N.language_codes&&f.value[1]?(o(),p("div",qa,[a("label",Ca,[H("Title* "),a("span",ka,"("+V(f.value[1])+")",1)]),i(he,{id:"title",type:"text",class:S({"p-invalid":P(e.value.translations[f.value[1]].title)}),modelValue:e.value.translations[f.value[1]].title,"onUpdate:modelValue":t[10]||(t[10]=R=>e.value.translations[f.value[1]].title=R),maxlength:"450"},null,8,["class","modelValue"]),Ua,P(e.value.translations[f.value[1]].title)?(o(),p("small",za,"Campo obbligatorio.")):_("",!0)])):_("",!0)])):_("",!0),e.value&&e.value.translations&&((be=e.value.country)!=null&&be.language_codes)?(o(),p("div",Aa,[a("div",$a,[a("label",Ta,[H("Short Description "),a("span",Da,"("+V(f.value[0])+")",1)]),i(xe,{id:"short_description",style:{height:"142px"},type:"text",modelValue:e.value.translations[f.value[0]].short_description,"onUpdate:modelValue":t[11]||(t[11]=R=>e.value.translations[f.value[0]].short_description=R),maxlength:"450"},null,8,["modelValue"]),Sa]),(Ve=e.value.country)!=null&&Ve.language_codes&&f.value[1]?(o(),p("div",Ia,[a("label",Fa,[H("Short Description "),a("span",Qa,"("+V(f.value[1])+")",1)]),i(xe,{id:"short_description",style:{height:"142px"},type:"text",maxlength:"450",modelValue:e.value.translations[f.value[1]].short_description,"onUpdate:modelValue":t[12]||(t[12]=R=>e.value.translations[f.value[1]].short_description=R)},null,8,["modelValue"]),Ea])):_("",!0)])):_("",!0),e.value&&e.value.translations&&((qe=e.value.country)!=null&&qe.language_codes)?(o(),p("div",ja,[a("div",Ba,[a("label",Na,[H("Description "),a("span",Ra,"("+V(f.value[0])+")",1)]),i(ye,{id:"short_description",modelValue:e.value.translations[f.value[0]].description,"onUpdate:modelValue":t[13]||(t[13]=R=>e.value.translations[f.value[0]].description=R),editorStyle:"height: 100px"},{toolbar:y(()=>[La]),_:1},8,["modelValue"])]),(Ce=e.value.country)!=null&&Ce.language_codes&&f.value[1]?(o(),p("div",Ma,[a("label",Oa,[H("Description "),a("span",Pa,"("+V(f.value[1])+")",1)]),i(ye,{id:"short_description",modelValue:e.value.translations[f.value[1]].description,"onUpdate:modelValue":t[14]||(t[14]=R=>e.value.translations[f.value[1]].description=R),editorStyle:"height: 100px"},{toolbar:y(()=>[Ha]),_:1},8,["modelValue"])])):_("",!0)])):_("",!0)]}),_:1}),i(ea,{title:"VIDEO","onUpdate:modelValue":t[15]||(t[15]=c=>Re(c)),class:"mt-3",ref_key:"uploadVideoCard",ref:Q},null,512),ae(i(rt,{title:"IMAGE",videoUrl:!1,ref_key:"uploadImageCard",ref:A,dynamicClass:"col-5",class:"mt-3"},null,512),[[ke,e.value.country]]),i(vt,{title:"ATTACHMENTS",videoUrl:!1,ref_key:"uploadAttachmentCard",ref:d},null,512),i(ee,{class:"mt-4"},{content:y(()=>[Ga,e.value&&e.value.translations?(o(),p("div",Ya,[a("div",Za,[Ja,i(B,{modelValue:e.value.questions_number,"onUpdate:modelValue":t[16]||(t[16]=c=>e.value.questions_number=c),options:[1,2,3,4,5,6],class:"capitalize",onChange:t[17]||(t[17]=c=>X())},null,8,["modelValue"])]),Ka])):_("",!0),i(Ye,{activeIndex:O.value,"onUpdate:activeIndex":t[20]||(t[20]=c=>O.value=c)},{default:y(()=>[(o(!0),p(ze,null,Xe(C.value,(c,K)=>(o(),I(Ge,{key:K},{header:y(()=>[a("span",null,V(c.title),1),e.value.questions.length>1?ae((o(),p("i",{key:0,class:"pi pi-times",onClick:N=>Ie(N,K)},null,8,Wa)),[[Ze,"Delete",void 0,{top:!0}]]):_("",!0)]),default:y(()=>[(o(),I(Mt,{quiz:e.value,index:K,languages:f.value,"submit-form":U.value,key:z.value,onUpdateAnswer:t[18]||(t[18]=N=>Fe(N)),onUpdateText:t[19]||(t[19]=N=>Qe(N))},null,8,["quiz","index","languages","submit-form"]))]),_:2},1024))),128))]),_:1},8,["activeIndex"])]),_:1})]),i(de,{group:"push",id:"push"},{message:y(c=>[a("div",Xa,[a("i",{class:S(c.message.icon),style:{"font-size":"1.5rem"}},null,2),a("p",el,V(c.message.message),1)]),a("div",tl,[i(D,{label:"Cancel",class:"mr-3 p-button-text text-500",onClick:re}),i(D,{label:"Send",class:"mr-4",onClick:Me})])]),_:1}),i(de,{group:"delete",id:"delete"},{message:y(c=>[a("div",al,[a("i",{class:S(c.message.icon),style:{"font-size":"1.5rem"}},null,2),a("p",ll,V(c.message.message),1)]),a("div",sl,[i(D,{label:"No",class:"mr-3 p-button-text text-500",onClick:re}),i(D,{label:"Yes",class:"mr-4",onClick:K=>{var N;return Oe((N=c.message)==null?void 0:N.acceptLabel)}},null,8,["onClick"])])]),_:1}),i(de,{group:"notification-group",id:"notification-group"},{message:y(()=>{var c;return[a("div",nl,[ol,a("p",null," Last push sent at: "+V(ce(dt)((c=ce(v))==null?void 0:c.last_notification_at)),1)])]}),_:1})],64)}}});export{wl as default};
