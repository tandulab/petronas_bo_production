import{d as A,o as U,u as B,af as M,r as S,t as N,c as T,a as y,b as r,e as h,f as v,h as n,z as _,g as t,m as V,A as C,j as P,C as z}from"./usetoast.esm40505.js";import{u as I,r as k}from"./index.esm405052.js";import{s as q,h as L,e as $}from"./helpers40505.js";import{u as D,L as E}from"./sidebar40505.js";import{u as F}from"./country40505.js";import{u as R}from"./product40505.js";import{a as W}from"./runtime-dom.esm-bundler40505.js";import{_ as G}from"./_plugin-vue_export-helper40505.js";const H=A({name:"LoginView",setup(){U(()=>{d.setSidebarVisibility(!1)});const e=B(),s=M(),d=D(),b=F(),g=S(1),i=N({email:"",password:"",terms:null}),u={password:{required:k},email:{required:k}},m=S(!1),p=I(u,i),c=T(()=>e.user),f=R(),w=a=>{m.value=!0,a&&(q(),o().then(()=>{L(),c.value.force_change_password&&y.push({name:"reset-password"}),d.setSidebarVisibility(!0),j(),x(),y.push({name:"users"})}).catch(l=>{L(),$(s,l)}))};async function o(){const a={login:i.email,password:i.password};await e.login(a)}const j=async function(){const a=new Map;await b.fetchAllCountries(a).catch(l=>{$(s,l)})},x=async function(){const a=new Map;await f.fetchAllProducts(a).catch(l=>{$(s,l)})};return{formStep:g,formSubmitted:m,v$:p,currentUser:c,handleSubmit:w}},components:{LogoPetronas:E}});const J={class:"flex justify-content-center align-items-center h-screen"},K={class:"mt-5 text-center"},O=t("h1",{class:"text-center mb-2"},"Sign In!",-1),Q=t("h2",{class:"font-normal mb-4"}," Welcome! Please enter your email and password. ",-1),X={key:0,class:"p-error w-100"},Y={class:"w-full flex flex-column flex-1"},Z={class:"flex justify-content-between mt-1"},ee={key:0,class:"p-error col-5 p-0 m-0"},se={class:"w-full flex justify-content-end text-sm cursor-pointer text-color-secondary"},oe={class:"mt-2 text-right w-full mb-3"};function te(e,s,d,b,g,i){const u=r("LogoPetronas"),m=r("InputText"),p=r("Password"),c=r("router-link"),f=r("Button"),w=r("Card");return h(),v("div",J,[n(w,{class:"p-4"},{header:_(()=>[t("div",K,[n(u,{class:"w-7rem"})])]),content:_(()=>[O,Q,t("form",{class:"mt-4 flex flex-column",onSubmit:s[2]||(s[2]=W(o=>e.handleSubmit(!e.v$.$invalid),["prevent"]))},[n(m,{id:"email",class:V({"p-invalid":e.v$.email.$invalid&&e.formSubmitted,"w-100":!0,"mb-1":!0}),placeholder:"Username*",modelValue:e.v$.email.$model,"onUpdate:modelValue":s[0]||(s[0]=o=>e.v$.email.$model=o)},null,8,["class","modelValue"]),e.formSubmitted&&e.v$.email.$errors.length>0?(h(),v("label",X,C(e.v$.email.$errors.map(o=>o.$message).join("<br />")),1)):P("",!0),t("div",Y,[n(p,{modelValue:e.v$.password.$model,"onUpdate:modelValue":s[1]||(s[1]=o=>e.v$.password.$model=o),feedback:!1,toggleMask:"",id:"password",placeholder:"Password*",class:V(["w-100 mt-3 mb-1",{"p-invalid":e.v$.password.$invalid&&e.formSubmitted}])},null,8,["modelValue","class"]),t("div",Z,[e.formSubmitted&&e.v$.password.$errors.length>0?(h(),v("label",ee,C(e.v$.password.$errors.map(o=>o.$message).join("<br />")),1)):P("",!0),t("div",se,[n(c,{to:"/forgot-password",class:"text-color-secondary"},{default:_(()=>[z("Forgot Password?")]),_:1})])])]),t("div",oe,[n(f,{type:"submit",label:"Sign in",class:"w-full mt-4 capitalize"})])],32)]),_:1})])}const ue=G(H,[["render",te]]);export{ue as default};
