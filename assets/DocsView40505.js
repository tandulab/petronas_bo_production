import{ae as A,at as E,ad as O,r as U,af as B,b as w,e as r,i as G,z as S,g as s,h as m,f as d,F as R,y as j,A as k,j as D,d as P,t as W,c as q,o as H,am as i,ar as J,as as K}from"./usetoast.esm40505.js";import{l as Q,i as X,s as V,h as F,a as Y,e as I,b as Z}from"./helpers40505.js";import{u as $}from"./attachment40505.js";import{_ as L}from"./_plugin-vue_export-helper40505.js";class z{static async fetchDocs(){return(await A("/pl_docs")).data}static async updateDocs(n){return(await E("/pl_docs",n)).data}}const ee=O({id:"docs",state:()=>({docs:{}}),getters:{getDocs:c=>c.docs},actions:{async fetchDocs(){const c=await z.fetchDocs();this.docs=c.pl_doc},async updateDocs(c){const n=await z.updateDocs(c);this.docs=n.pl_doc}}}),te={props:{title:String,videoUrl:Boolean,accept:String,placeholder:String},setup(c,n){const e=U(),a=$(),y=B(),p=U(),h=U(),g=U(),C=c.accept?c.accept:"image/*,.pdf,.doc,.xls,.xlsx,.csv",o=f=>{e.value=[],p.value=f.files},t=(f,M)=>{f&&(V(),a.deleteAttachment(f).then(()=>{F(),Y(y,{message:"File deleted correctly.",title:""}),u(M)}).catch(N=>{F(),I(y,N)}))},u=f=>{e.value.splice(f,1),e.value.length==0&&(e.value=null)},_=f=>{p.value.splice(f,1)},l=()=>{p.value=[]},v=()=>e.value&&e.value.length>0?10-e.value.length:10,x=f=>f.type==="image/jpeg";return n.expose({tmp_attachment:e,files:p,fileUpload:h,folder_url:g,clearFiles:l}),{tmp_attachment:e,files:p,fileUpload:h,folder_url:g,accept:C,onSelectedFiles:o,deleteImage:t,formatSize:Q,deleteGalleryImage:u,deleteFile:_,checkFileLimit:v,checkIsImage:x,getFileName:X}}};const le={class:"flex align-items-center justify-content-between col-10"},ae={class:"flex col-10"},oe={key:0},se=s("h4",{class:"mb-1 mt-0"},"Pending",-1),ie={class:"flex flex-wrap"},ne={class:"flex align-items-center"},ce=["alt","src"],re={key:1,class:"pi pi-file text-2xl"},de={class:"flex flex-column ml-2",style:{"font-size":"12px"}},me={class:"mb-1"},ue={key:0,class:"mb-1 mt-3"},fe={class:"flex flex-wrap"},pe={class:"flex align-items-center"},_e=["src"],he={key:1,class:"pi pi-file text-2xl"},ge={class:"flex flex-column ml-2",style:{"font-size":"12px"}},ve={class:"mb-1"},xe={key:0,class:"text-center"},ye=s("b",null,"Drag and drop files to here to upload.",-1),be=s("p",{class:"text-xs"},"(Maximum size 2 MB)",-1),we=[ye,be];function Ce(c,n,e,a,y,p){const h=w("InputText"),g=w("Button"),C=w("FileUpload"),o=w("Card");return r(),G(o,{class:"mt-4"},{content:S(()=>[s("div",le,[m(h,{value:e.title,id:"name",type:"text",class:"w-full",placeholder:e.placeholder,"onUpdate:modelValue":n[0]||(n[0]=t=>c.$emit("titleChanged",t))},null,8,["value","placeholder"])]),s("div",ae,[m(C,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,maxFileSize:2e7,id:"logo",modelValue:a.tmp_attachment,"onUpdate:modelValue":n[1]||(n[1]=t=>a.tmp_attachment=t),customUpload:!0,onSelect:a.onSelectedFiles,fileLimit:a.checkFileLimit(),ref:"fileUpload",disabled:a.tmp_attachment&&a.tmp_attachment.length>=10,accept:a.accept},{content:S(()=>[a.files&&a.files.length>0?(r(),d("div",oe,[se,s("div",ie,[(r(!0),d(R,null,j(a.files,(t,u)=>(r(),d("div",{key:t.name+t.type+t.size,class:"card m-0 flex border-1 surface-border align-items-center justify-content-between pl-4 pr-3 py-3 w-full my-2"},[s("div",ne,[a.checkIsImage(t)?(r(),d("img",{key:0,role:"presentation",alt:t.name,src:t.objectURL,width:"50",class:"shadow-2"},null,8,ce)):(r(),d("i",re)),s("div",de,[s("div",me,k(t.name),1),s("div",null,k(a.formatSize(t.size)),1)])]),m(g,{icon:"pi pi-times",onClick:_=>a.deleteFile(u),class:"p-button p-component p-button-icon-only p-fileupload-file-remove p-button-text p-button-danger p-button-rounded"},null,8,["onClick"])]))),128))])])):D("",!0),a.tmp_attachment&&a.tmp_attachment[0]&&a.tmp_attachment[0].id?(r(),d(R,{key:1},[a.files&&a.files.length>0?(r(),d("h4",ue," Completed ")):D("",!0),s("div",fe,[(r(!0),d(R,null,j(a.tmp_attachment,(t,u)=>(r(),d("div",{key:t.id,class:"card m-0 flex border-1 surface-border align-items-center justify-content-between pl-4 pr-3 py-3 w-full my-2"},[s("div",pe,[a.checkIsImage(t)?(r(),d("img",{key:0,role:"presentation",src:t.url,width:"50",class:"shadow-2"},null,8,_e)):(r(),d("i",he)),s("div",ge,[s("div",ve,k(a.getFileName(t.url)),1)])]),m(g,{icon:"pi pi-times",onClick:_=>a.deleteImage(t.id,u),class:"p-button p-component p-button-icon-only p-fileupload-file-remove p-button-text p-button-danger p-button-rounded"},null,8,["onClick"])]))),128))])],64)):D("",!0)]),empty:S(()=>[a.tmp_attachment?D("",!0):(r(),d("div",xe,we))]),_:1},8,["modelValue","onSelect","fileLimit","disabled","accept"])])]),_:1})}const b=L(te,[["render",Ce]]),T=c=>(J("data-v-eca8079f"),c=c(),K(),c),Ue={class:"flex flex-column"},De={class:"flex flex-row justify-content-between align-items-center mb-3"},Se=T(()=>s("h1",{class:"uppercase my-0"},[s("span",null,"Docs")],-1)),Fe={class:"grid"},Re={class:"col-6 flex flex-column"},ke=T(()=>s("h2",{class:"uppercase"},"MateriaÅ‚y reklamowe",-1)),Ie={class:"col-6 flex flex-column"},Te=T(()=>s("h2",{class:"uppercase"},"Na warsztaty",-1)),je=P({__name:"DocsView",setup(c){const n=ee(),e=W({catalog:{1:{uploadRef:null,title:null,fileUrl:null},2:{uploadRef:null,title:null,fileUrl:null},3:{uploadRef:null,title:null,fileUrl:null}},material:{1:{uploadRef:null,title:null,fileUrl:null},2:{uploadRef:null,title:null,fileUrl:null},3:{uploadRef:null,title:null,fileUrl:null}}}),a=U(!1),y=B();q(()=>n.getDocs);async function p(){var u,_;const o=new FormData,t={};for(const l of Object.keys(e.catalog)){const v=(u=e.catalog[l].uploadRef.files)==null?void 0:u[0];v&&(t[`catalog_file_${l}`]=v);const x=e.catalog[l].title;x&&(t[`catalog_title_${l}`]=x)}for(const l of Object.keys(e.material)){const v=(_=e.material[l].uploadRef.files)==null?void 0:_[0];v&&(t[`material_file_${l}`]=v);const x=e.material[l].title;x&&(t[`material_title_${l}`]=x)}Z(o,t);try{a.value=!0,await n.updateDocs(o),g(),h(n.getDocs)}catch(l){I(y,l)}finally{a.value=!1}}function h(o){["1","2","3"].forEach(t=>{e.catalog[t].title=o[`catalog_title_${t}`]??null,e.catalog[t].fileUrl=o[`catalog_file_${t}_url`]??null,e.material[t].title=o[`material_title_${t}`]??null,e.material[t].fileUrl=o[`material_file_${t}_url`]??null,e.catalog[t].fileUrl&&(e.catalog[t].uploadRef.tmp_attachment=[e.catalog[t].fileUrl]),e.material[t].fileUrl&&(e.material[t].uploadRef.tmp_attachment=[e.material[t].fileUrl])})}function g(){for(const o of Object.keys(e.catalog))e.catalog[o].uploadRef.tmp_attachment=[],e.catalog[o].uploadRef.clearFiles(),e.catalog[o].title=null,e.catalog[o].fileUrl=null;for(const o of Object.keys(e.material))e.material[o].uploadRef.tmp_attachment=[],e.material[o].uploadRef.clearFiles(),e.material[o].title=null,e.material[o].fileUrl=null}async function C(){try{V(),await n.fetchDocs(),F()}catch(o){I(y,o)}finally{F()}h(n.getDocs)}return H(()=>{C()}),(o,t)=>{const u=w("Button"),_=w("Card");return r(),d("div",null,[m(_,{class:"mt-3"},{content:S(()=>[s("div",Ue,[s("div",De,[Se,m(u,{label:"Save",onClick:p,loading:a.value},null,8,["loading"])]),s("div",Fe,[s("div",Re,[ke,m(b,{placeholder:"Catalog file 1",onTitleChanged:t[0]||(t[0]=l=>i(e).catalog[1].title=l),title:i(e).catalog[1].title??void 0,ref:l=>i(e).catalog[1].uploadRef=l},null,8,["title"]),m(b,{placeholder:"Catalog file 2",title:i(e).catalog[2].title??void 0,onTitleChanged:t[1]||(t[1]=l=>i(e).catalog[2].title=l),ref:l=>i(e).catalog[2].uploadRef=l},null,8,["title"]),m(b,{placeholder:"Catalog file 3",title:i(e).catalog[3].title??void 0,onTitleChanged:t[2]||(t[2]=l=>i(e).catalog[3].title=l),ref:l=>i(e).catalog[3].uploadRef=l},null,8,["title"])]),s("div",Ie,[Te,m(b,{placeholder:"Material file 1",title:i(e).material[1].title??void 0,onTitleChanged:t[3]||(t[3]=l=>i(e).material[1].title=l),ref:l=>i(e).material[1].uploadRef=l},null,8,["title"]),m(b,{placeholder:"Material file 2",title:i(e).material[2].title??void 0,onTitleChanged:t[4]||(t[4]=l=>i(e).material[2].title=l),ref:l=>i(e).material[2].uploadRef=l},null,8,["title"]),m(b,{placeholder:"Material file 3",title:i(e).material[3].title??void 0,onTitleChanged:t[5]||(t[5]=l=>i(e).material[3].title=l),ref:l=>i(e).material[3].uploadRef=l},null,8,["title"])])])])]),_:1})])}}});const Me=L(je,[["__scopeId","data-v-eca8079f"]]);export{Me as default};
